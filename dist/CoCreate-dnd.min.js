!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.dnd=t():(e.CoCreate=e.CoCreate||{},e.CoCreate.dnd=t())}(this,function(){return r={},o.m=n=[function(e,t,n){var r=n(1),o=n(2),i=n(3),a=n(5);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.addEventListener("load",function(){var l={host:{document:document,window:window},guests:{}};window.iframes=l;var e=document.getElementsByTagName("iframe"),d=1,t=c(e);try{for(t.s();!(r=t.n()).done;){var n=r.value,r=n.id||"iframe".concat(d++);l.guests[r]={frame:n,document:n.contentDocument,window:n.contentWindow},n.contentWindow.iframes=l}}catch(e){t.e(e)}finally{t.f()}new MutationObserver(function(e,t){var n=c(e);try{for(n.s();!(r=n.n()).done;){var r=r.value;if("childList"===r.type){var o=c(r.addedNodes);try{for(o.s();!(i=o.n()).done;){var i,a=i.value;"IFRAME"===a.tagName&&(i=a.id||"iframe".concat(d++),l.guests[i]={frame:a,document:a.contentDocument,window:a.contentWindow},a.contentWindow.iframes=l)}}catch(e){o.e(e)}finally{o.f()}}}}catch(e){n.e(e)}finally{n.f()}}).observe(document.body,{attributes:!0,childList:!0,subtree:!0})})},function(e,t){var n=null,r=null;document.addEventListener("mousedown",function(e){1===e.which&&(n=e.target,r=(new Date).getTime())}),document.addEventListener("mouseup",function(e){var t=(new Date).getTime();n==e.target&&t<r+500&&(t=new CustomEvent("CoCreateClickLeft",{bubbles:!0}),e.target.dispatchEvent(t))})},function(e,t,n){"use strict";n.r(t),n.d(t,"initContainer",function(){return X}),n.d(t,"initElement",function(){return F}),n.d(t,"initFunction",function(){return U}),n.d(t,"initIframe",function(){return P});var r=n(0),w=n.n(r);window.parent===window&&(window.addEventListener("load",function(){CoCreate.socket.listen("domEditor",function(e){if(console.log("raw object recieved: ",e.target,e.value[1],window.location.pathname),e.target&&(e.target=document.querySelector('[data-element_id="'.concat(e.target,'"]'))),e.value[1]&&(e.value[1]=document.querySelector('[data-element_id="'.concat(e.value[1],'"]'))),!e.target)return console.log("dnd error: draggble is null");if(!e.value[1])return console.log("dnd error: droppable is null");var t=w()(e.value,2),n=t[0],t=t[1];e.target.insertAdjacentElement(n,t)}),CoCreate.socket.listen("dndNewElement",function(e){console.log("raw object recieved: ",e.target,e.value[1],window.location.pathname);try{if(e.path.length?(a=(i=document.querySelector(e.path[0])).contentWindow.document||i.contentDocument,e.target=a.querySelector("[data-element_id=".concat(e.target,"]"))):e.target=document.querySelector("[data-element_id=".concat(e.target,"]")),e.value[1]=CoCreate.utils.parseTextToHtml(e.value[1]),e.hiddenAttribute)for(var t=0,n=Object.entries(e.hiddenAttribute);t<n.length;t++){var r=w()(n[t],2),o=r[0],r=r[1];e.value[1].setHiddenAttribute(o,r)}var i=w()(e.value,2),a=i[0],i=i[1];e.target.insertAdjacentElement(a,i)}catch(e){console.error(e)}})}),window.addEventListener("dndsuccess",function(e){var t=e.detail,n=t.dropedEl,r=t.dragedEl,o=t.position,i=t.dropType,e=t.path,t=(r.ownerDocument!==n.ownerDocument?window.iframes.guests.canvas.window:window).CoCreate;n.getAttribute("data-element_id")||n.setAttribute("data-element_id",t.utils.UUID()),n=n.getAttribute("data-element_id"),"data-cloneable"===i?(i=r.getAllHiddenAttribute(),r=r.outerHTML,t.message.send({broadcast_sender:!1,rooms:"",emit:{message:"dndNewElement",data:{target:n,method:"insertAdjacentElement",value:[o,r],path:e,hiddenAttribute:i}}})):(r.getAttribute("data-element_id")||r.setAttribute("data-element_id",t.utils.UUID()),r=r.getAttribute("data-element_id"),t.message.send({broadcast_sender:!0,rooms:"",emit:{message:"domEditor",data:{target:n,method:"insertAdjacentElement",value:[o,r]}}}))}));n(6);var u="data-droppable",c="data-exclude",p="data-draggable",h="data-cloneable",a="data-handle",s="data-group_name";function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=[];function f(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}for(var m,g=window;g!==window.parent;)g=window.parent;function v(e,t){return e.tagName||(e=e.parentElement),m.getContext(e,t)}function y(e,t){return e.tagName||(e=e.parentElement),m.getContexts(e,t)}function b(e){for(e.tagName||(e=e.parentElement);;){var t=e.getAttribute(s);if(t)return[e,t];if(!(e=e.parentElement))return[null,void 0]}}g.dndContext?m=g.dndContext:(m=new function(e){this.map=new Map,this.checkInitFunction=function(e,t){var n=o(i);try{for(n.s();!(r=n.n()).done;){var r=r.value;if(r.target.contains(e)){r=r.onDnd(e,t);if(Array.isArray(r))return r}}}catch(e){n.e(e)}finally{n.f()}},this.getContext=function(e,t){do{if("true"==e.getAnyAttribute(t))return e;if(this.checkInitFunction(e,[t]))return e}while(e=e.parentElement)},this.getContexts=function(e,t){do{var n=o(t);try{for(n.s();!(r=n.n()).done;){var r=r.value;if("true"==e.getAnyAttribute(r))return[e,r];r=this.checkInitFunction(e,t);if(Array.isArray(r)&&t.includes(r[1]))return r}}catch(e){n.e(e)}finally{n.f()}}while(e=e.parentElement)},this.setContext=function(e,t,n){e.setHiddenAttribute(t,n)}},g.dndContext=m);function E(a,n,r){var l=this;this.effectCb,n.removeAttribute("CoC-dragging"),this.start=function(){l.cloneEl=n.cloneNode(!0);var e=r.window.getComputedStyle(n),t=e.width,e=e.height;window.getComputedStyle(l.cloneEl);l.wrapper=document.createElement("div"),l.wrapper.style.height=e,l.wrapper.style.width=t,l.wrapper.append(l.cloneEl),l.wrapper.style.display="none",r.document.body.append(l.wrapper),l.wrapper.style.pointerEvents="none",l.wrapper.id="ghostEffect"},this.draw=function(e,t){l.wrapper.style.display="block";l.wrapper.getBoundingClientRect();var n,r,o,i,r=(n=l.cloneEl,r=["marginTop","marginBottom","marginLeft","marginRight","width","height"],o=window.getComputedStyle(n),i={},r.forEach(function(e){i[e]=parseInt(o[e])}),i),t=(r.marginTop,r.marginBottom,r.marginLeft,r.marginRight,r.width,r.height,t.frame?t.frame.getBoundingClientRect():{top:0,left:0});l.wrapper.style.top=t.top+e.y-a.offsetY+"px",l.wrapper.style.left=t.left+e.x-a.offsetX+"px"},this.hide=function(){l.wrapper.remove()}}function A(e,t,n,r,o,i){var a=o-n,l=i-r,d=a*a+l*l,d=0!=d?((e-n)*a+(t-r)*l)/d:-1,l=d<0?(c=n,r):1<d?(c=o,i):(c=n+d*a,r+d*l),c=e-c,l=t-l;return Math.sqrt(c*c+l*l)}function S(e,t){var n,r,o=1/0,i=f(t);try{for(i.s();!(l=i.n()).done;){var a,l,d=l.value;d.classList.contains("hidden")||(a=function(e,t){var n,r=t.getBoundingClientRect(),o={p1:[r.top,r.left],p2:[r.bottom,r.left]},i={p1:[r.top,r.left],p2:[r.top,r.right]},t={p1:[r.top,r.right],p2:[r.bottom,r.right]},r={p1:[r.bottom,r.left],p2:[r.bottom,r.right]},r=[A(e[0],e[1],o.p1[1],o.p1[0],o.p2[1],o.p2[0]),A(e[0],e[1],i.p1[1],i.p1[0],i.p2[1],i.p2[0]),A(e[0],e[1],t.p1[1],t.p1[0],t.p2[1],t.p2[0]),A(e[0],e[1],r.p1[1],r.p1[0],r.p2[1],r.p2[0])],a=1/0;return r.forEach(function(e,t){e<a&&(a=e,n=x[t])}),[n,a]}(e,d),a=(l=w()(a,2))[0],(l=l[1])<o&&(o=l,n=d,r=a))}}catch(e){i.e(e)}finally{i.f()}return[r,n]}var x=["left","top","right","bottom"];function C(){this.listener={},this.on=function(e,t){Object.hasOwnProperty(e)||(this.listener[e]=[]),this.listener[e].push(t)},this.dispatch=function(e,t){this.listener.hasOwnProperty(e)&&this.listener[e].forEach(function(e){return e(t)})}}var M=["left","top"];var j,k,D,O,L;n(7);var H,I,n={scroller:new function(e){var y=e.speed,b=e.threshold;this.lastScrollingElement,this.onElement,this.mouse,this.speed,this.interval,this.isActive,this.update=function(e,t){this.mouse={x:e,y:t}},this.calculateScroll=function(e){for(var t=e.x,n=e.y,r=e.element,o=e.onMouseScrollMove;!(r&&r.tagName&&(r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth))&&r.parentElement;)r=r.parentElement;var i,a,l,d,c,u,s=r.scrollWidth>r.clientWidth,f=r.scrollHeight>r.clientHeight,p=r.clientWidth/b,h=r.clientHeight/b,m=[],g=m[0],v=m[1];if(f?(e=[t,n],f={p1:[0,(d=(m=r).getBoundingClientRect()).left],p2:[0,d.right]},d={p1:[m.clientHeight,d.left],p2:[m.clientHeight,d.right]},d=[A(e[0],e[1],f.p1[1],f.p1[0],f.p2[1],f.p2[0]),A(e[0],e[1],d.p1[1],d.p1[0],d.p2[1],d.p2[0])],c=1/0,d.forEach(function(e,t){e<c&&(c=e,l=["top","bottom"][t])}),d=[l,c],g=(d=w()(d,2))[0],v=d[1]):s&&(d=[t,n],t=(s=r).getBoundingClientRect(),n={p1:[t.top,0],p2:[t.bottom,0]},s={p1:[t.top,s.clientWidth],p2:[t.bottom,s.clientWidth]},s=[A(d[0],d[1],n.p1[1],n.p1[0],n.p2[1],n.p2[0]),A(d[0],d[1],s.p1[1],s.p1[0],s.p2[1],s.p2[0])],a=1/0,s.forEach(function(e,t){e<a&&(a=e,i=["left","right"][t])}),s=[i,a],g=(s=w()(s,2))[0],v=s[1]),g){switch(g){case"top":case"bottom":this.speed=h/(v+1)*y,u=v<h;break;case"left":case"right":this.speed=p/(v+1)*y,u=v<p}u?this.isActive?this.isActive&&this.lastScrollingElement!==r&&(this.deactivateScroll(r),this.__activateScroll(r,g,o)):(this.isActive=!0,this.__activateScroll(r,g,o)):this.isActive&&(console.log("no",g,r),this.isActive=!1,this.deactivateScroll(r))}},this.__activateScroll=function(e,t,n){var r=this;e.style.scrollBehavior="auto",this.lastScrollingElement=e,this.interval=setInterval(function(){switch(t){case"top":e.scrollBy(0,-r.speed);break;case"bottom":e.scrollBy(0,r.speed);break;case"left":e.scrollBy(-r.speed,0);break;case"right":e.scrollBy(r.speed,0)}},10)},this.deactivateScroll=function(e){e&&(e.style.scrollBehavior=""),clearInterval(this.interval)}}({speed:4,threshold:3}),myDropMarker:new function(l){l=Object.assign({borderSize:2,dropMarkerMargin:5},l);var d=document.createElement("div");d.id="dropMarker",d.style.pointerEvents="none",this.lastOrigntaion=void 0,document.body.append(d),this.obj=d,this.draw=function(e,t,n,r,o){d.style.display="block";var i,a=t.getBoundingClientRect();switch(a.width||a.height||(a=e.getBoundingClientRect(),n="top"),n){case"top":case"bottom":d.style.height=l.borderSize+"px",d.style.width=a.width+"px";break;case"left":case"right":d.style.width=l.borderSize+"px",d.style.height=a.height+"px";break;default:throw new Error("one type of orientation must be specified")}switch(e!=t&&(t=e.getBoundingClientRect()[n],e=a[n],Math.abs(t-e)<2*l.dropMarkerMargin&&(r=!0)),i=o.frame?o.frame.getBoundingClientRect():{top:0,left:0},d.style.transition="top,left 0.2s ease-in-out",n){case"top":d.style.top=i.top+a.top-l.borderSize/2+window.scrollY+(r?l.dropMarkerMargin:-l.dropMarkerMargin)+"px",d.style.left=i.left+a.left-l.borderSize/2+window.scrollX+"px";break;case"bottom":d.style.top=i.top+a.bottom-l.borderSize/2+window.scrollY+(r?-l.dropMarkerMargin:l.dropMarkerMargin)+"px",d.style.left=i.left+a.left-l.borderSize/2+window.scrollX+"px";break;case"left":d.style.top=i.top+a.top-l.borderSize/2+window.scrollY+"px",d.style.left=i.left+a.left-l.borderSize/2+window.scrollX+(r?l.dropMarkerMargin:-l.dropMarkerMargin)+"px";break;case"right":d.style.top=i.top+a.top-l.borderSize/2+window.scrollY+"px",d.style.left=i.left+a.right-l.borderSize/2+window.scrollX+(r?-l.dropMarkerMargin:l.dropMarkerMargin)+"px";break;default:throw new Error("one type of orientation must be specified")}this.lastOrigntaion=n},this.hide=function(e){d.style.display="none"}}},T=n.myDropMarker,_=n.scroller,B=new function(o){var l=this;this.dragedEl,this.dropedEl,this.position,this.id,this.type;var d=new C;this.on=function(){d.on.apply(d,arguments)},this.dragStart=function(e,t,n,r,o){l.id=n,l.dropType=o,console.log({comment:"dragStart"}),l.dragedEl=t,d.dispatch("dragStart",{e:e,el:t,ref:r})},this.dragEnd=function(e,t){try{if(l.dragedEl&&l.dragedEl.removeAttribute("CoC-dragging"),l.position){if(l.dropedEl===l.dragedEl)throw"dnd cancelled. you can't dnd on the same element.";if(l.dragedEl.contains(l.dropedEl))throw"dnd cancelled, you can't dnd from parent to its children.";var n=CoCreate.utils.getElementPath(l.dropedEl),n={position:l.position,dragedEl:l.dragedEl,dropedEl:l.dropedEl,dropType:l.dropType,path:n};o&&(r=o(n)),Object.assign(n,r);var r=new CustomEvent("dndsuccess",{bubbles:!1,detail:n});l.dropedEl.insertAdjacentElement(l.position,l.dragedEl),window.dispatchEvent(r,{bubbles:!1})}}catch(e){console.error(e)}finally{l.type&&(l.position=null,console.log("dnd completed","type:",l.type,"position:",l.position)),d.dispatch("dragEnd",{e:e,ref:t})}},this.dragOver=function(e,t,n){var r,o,i,a;l.dragedEl&&l.dragedEl.setAttribute("CoC-dragging",!0),0===t.children.length?(i=S([e.x,e.y],[t]),r=(o=w()(i,2))[0],a=o[1],d.dispatch("dragOver",{e:e,el:t,closestEl:a,orientation:r,hasChild:!0,ref:n}),l.position=M.includes(r)?"afterbegin":"beforeend",l.dropedEl=t,l.type="normal"):(i=S([e.x,e.y],t.children),a=(o=w()(i,2))[0],"true"==(r=o[1]).getAttribute("data-exclude")?(l.dropedEl=r.parentElement,i=S([e.x,e.y],[l.dropedEl]),i=(o=w()(i,2))[0],o[1],a=i):l.dropedEl=r,d.dispatch("dragOver",{e:e,el:t,closestEl:r,orientation:a,hasChild:!1,ref:n}),l.position=M.includes(a)?"beforebegin":"afterend",l.type="children")}}(function(){return k?k.apply(null,arguments):{}});B.on("dragStart",function(e){T.hide(),(H=new E(e.e,e.el,{window:window,document:document})).start()}),B.on("dragEnd",function(e){T.hide(),H&&H.hide(e.ref)}),B.on("dragOver",function(e){T.draw(e.el,e.closestEl,e.orientation,!!e.hasChild,e.ref)});var q=!1;function R(e,t){var n=y(e.target,[p,h,a]);if(Array.isArray(n)){var r=w()(n,2),o=r[0],n=r[1];switch(n){case h:var i=o.getAttribute("data-insert-html");if(i){if(i=i,!(o=(i=(new DOMParser).parseFromString(i,"text/html")).head.children[0]||i.body.children[0]))return}else o=o.cloneNode(!0);break;case p:if(o.getAnyAttribute(a))return;break;default:o=v(o,p)}r=b(o);I=r[1],t.document.body.style.cursor="crosshair !important",q=!0,B.dragStart(e,o,null,t,n)}}function W(e,t){t.document.body.style.cursor="",q=!1,B.dragEnd(e),T.hide(),_.deactivateScroll()}function N(e,t,n){var r=e.x,o=e.y,i=e.target;e.isTouch;if(q){if(H&&H.draw({x:r,y:o},t),_.update(r,o),q){var a=b(i),a=w()(a,2),l=a[0],d=a[1];if(I&&d){if(I!==d)for(;;){var c=b(l);if(!c[0])return;if(l=c[0].parentElement,d=c[1],I===d){i=c[0];break}}}else if(I!==d)return}else H&&H.hide();!i||(a=v(i,u))&&(n||_.calculateScroll({x:r,y:o,element:a.parentElement,onMouseScrollMove:function(e){return N(e,t,!0)}}),B.dragOver({x:r,y:o,target:a},a,t))}}L=function(e,t){1==e.which&&R(e,t)},O=function(e,t){1==e.which&&W(e,t)},D=function(e,t){N(e,t)};var z=new Map,P=function(e){var t,r,n,o,i,a,l,d,c=e.isIframe,u=e.frame,s=e.document,f=e.window;(r=c?(e=(t=u.contentWindow).document||u.contentDocument,{x:(c=u.getBoundingClientRect()).left,y:c.top,frame:u,window:t,document:e,isIframe:!0}):{x:0,y:0,window:f,document:s,isIframe:!1}).window.CoCreateDnd&&r.window.CoCreateDnd.hasInit||(r.document.querySelector("#dnd-style")||((s=r.document.createElement("style")).id="dnd-style",s.innerHTML='    /* dnd specic */\n      [data-draggable="true"], [data-cloneable="true"]  {\n        touch-action: none;\n      }\n      /* dnd specic */',r.document.head.append(s)),r.document.addEventListener("dragstart",function(e){return e.preventDefault(),!1}),r.document.addEventListener("selectstart",function(e){var t=y(e.target,[p,h]);Array.isArray(t)&&e.preventDefault()},{passive:!1}),z.has(r.window)?(n=(d=z.get(r.window)).mousemovee,o=d.mouseupe,i=d.mousedowne,a=d.touchmovee,l=d.touchheade,d=d.touchstarte):(d=function(e){j&&clearTimeout(j),j=setTimeout(function(){console.log("touch start"),r.document.body.style.touchAction="none",e.preventDefault(),R(e,r)},1e3)},l=function(e){r.document.body.style.touchAction="auto",q?(e.preventDefault(),W(e,r)):j&&clearTimeout(j)},a=function(e){if(!q)return j&&clearTimeout(j),void console.log("touch scroll");console.log("touch dnd"),e.preventDefault();var t=e.touches[0],n=t.clientX,e=t.clientY,t=r.document.elementFromPoint(n,e);t&&N({x:n,y:e,target:t,isTouch:!0},r)},i=function(e){L.apply(this,[e,r])},o=function(e){O.apply(this,[e,r])},n=function(e){D.apply(this,[e,r])},z.set(r.window,{mousemovee:n,mouseupe:o,mousedowne:i,touchmovee:a,touchheade:l,touchstarte:d})),r.document.removeEventListener("touchstart",d),r.document.addEventListener("touchstart",d),r.document.removeEventListener("touchend",l,{passive:!1}),r.document.addEventListener("touchend",l,{passive:!1}),r.document.removeEventListener("touchmove",a,{passive:!1}),r.document.addEventListener("touchmove",a,{passive:!1}),r.document.removeEventListener("mousedown",i),r.document.addEventListener("mousedown",i),r.document.removeEventListener("mouseup",o),r.document.addEventListener("mouseup",o),r.document.removeEventListener("mousemove",n),r.document.addEventListener("mousemove",n))};window.addEventListener("load",function(){window.parent===window&&(P({document:document,window:window}),window.CoCreate.observer.init({name:"dnd-config",observe:["childList"],callback:function(e){document.querySelectorAll(".sortable").forEach(function(e){X({target:e})}),document.querySelectorAll(".cloneable").forEach(function(e){X({target:e,cloneable:!0})})}}))});var U=function(e){var t=e.target,n=e.onDnd,e=e.onDndSuccess;"function"==typeof e&&(k=e),i.push({target:t,onDnd:n})},F=function(e){var t=e.target,n=e.dropable,r=e.draggable,o=e.cloneable,i=(e.handle,e.group),a=e.exclude,l=e.beforeDndSuccess;try{if("function"==typeof l&&(k=l),i&&t.setHiddenAttribute(s,i),a)try{t.querySelectorAll(a).forEach(function(e){e.setHiddenAttribute(c,"true")})}catch(e){throw e instanceof HTMLElement&&console.error("Dnd Sortable: exclude must be valid selector"),e}n&&t.querySelectorAll(n).forEach(function(e){e.setHiddenAttribute(u,"true")}),r&&t.querySelectorAll(r).forEach(function(e){e.setHiddenAttribute(p,"true")}),o&&t.querySelectorAll(o).forEach(function(e){e.setHiddenAttribute(h,"true")})}catch(e){if(e instanceof DOMException)throw console.error("Dnd Sortable: handle must be a valid selector"),e;throw e}};var X=function(e){var t=e.target,n=e.cloneable,r=void 0!==n&&n,o=e.nested,n=void 0!==o&&o,i=e.handle,o=e.group,a=e.exclude;if(o&&t.setHiddenAttribute(s,o),a)try{t.querySelectorAll(a).forEach(function(e){e.setHiddenAttribute(c,"true")})}catch(e){if(e instanceof DOMException){var l="Dnd Sortable: exclude must be valid selector";throw console.error(l),l}throw e}if(!t.tagName){l="Dnd Sortable: Please provide a valid element";throw console.error(l),l}if("boolean"!=typeof r){var d="Dnd Sortable: please provide valid data type for cloneable";throw console.error(d),d}if("boolean"!=typeof n){d="Dnd Sortable: please provide valid data type for nested";throw console.error(d),d}n?function t(e,n){e.children.length&&Array.from(e.children).forEach(function(e){t(e),e.setHiddenAttribute(c,"true"),e.setHiddenAttribute(p,"true"),n&&e.setHiddenAttribute(h,"true")})}(t,r):(t.setHiddenAttribute(u,"true"),t.children.length&&Array.from(t.children).forEach(function(e){r?e.setHiddenAttribute(h,"true"):e.setHiddenAttribute(p,"true");try{var t=e.querySelectorAll(i);i&&t.length&&(e.setHiddenAttribute(p,"true"),t.forEach(function(e){e.setHiddenAttribute(p,"true")}))}catch(e){if(e instanceof DOMException){var n="Dnd Sortable: handle must be a valid selector";throw console.error(n),n}throw e}}))},Y={initContainer:X,initElement:F,initFunction:U};t.default={initIframe:P,init:function(e){var t=e.mode;if(delete e.mode,!["function","element","container"].includes(t))throw new Error("invalid mode provided");t="init"+t.charAt(0).toUpperCase()+t.slice(1),Y[t].apply(null,[e])}}}],o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=8).default;function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var n,r});