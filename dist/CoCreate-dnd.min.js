!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CoCreate=e():(t.CoCreate=t.CoCreate||{},t.CoCreate.dnd=e())}(this,(function(){return(()=>{var t={980:function(t,e,n){var r,i;"undefined"!=typeof self&&self,r=[n(585),n(129)],void 0===(i=function(t,e){return function(t,e,n){if(t){let t=window.CoCreateCrudSocket;if(!t){let t=new e("ws");window.CoCreateCrudSocket=t}n.setSocket(t),n.createSocket(window.config.host?window.config.host:window.location.hostname,window.config.organization_Id)}return n}(!0,t,e)}.apply(e,r))||(t.exports=i)},129:function(t,e,n){var r,i;"undefined"!=typeof self&&self,r=[n(446)],void 0===(i=function(t){return function(t,e){return{socket:null,setSocket:function(t){this.socket=t},send:function(t){let n=e.getCommonParams();if(!t||!t.emit)return;n={...n,...t};const r=e.generateSocketClient(t.namespace,t.room);this.socket.send("sendMessage",n,r)},receive:function(t,e){this.socket.listen(t,e)},createSocket:function(t,e){this.socket&&(e?(this.socket.create({namespace:e,room:null,host:t}),this.socket.setGlobalScope(e)):this.socket.create({namespace:null,room:null,host:t}))},listen:function(t,e){this.socket.listen(t,e)},listenAsync:function(t){return this.socket.listenAsync(t)}}}(window,t)}.apply(e,r))||(t.exports=i)},366:(t,e,n)=>{"use strict";function r(t){this.callbackMap=new Map,this.callbackMap.set("ALL",{attributes:[],addedNodes:[],removedNodes:[],characterData:[],childList:[]});let[e,n]=this.runCallbackGen("attributes");this.runCallbackAtt=e,this.runCallbackAttAll=n,[e,n]=this.runCallbackGen("characterData"),this.runCallbackChar=e,this.runCallbackCharAll=n,this.runCallbackAdd=this.runCallbackExGen("addedNodes","addedNodes"),this.runCallbackRemove=this.runCallbackExGen("removedNodes","removedNodes");new MutationObserver((t=>this._callback.call(this,t))).observe(t,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0})}n.r(e),n.d(e,{default:()=>o}),window.counter=0;const i=["addedNodes","removedNodes","attributes","characterData","childList"];r.prototype.init=function({observe:t=["addedNodes","attributes"],attributeFilter:e,callback:n}){if(!t||!t.every((t=>i.includes(t))))throw"please enter a valid observe";if(this.observe=t,this.callback=n,e&&e.length)for(let t of e)this._register(t.toLowerCase());else this._register("ALL")},r.prototype._register=function(t){for(let e of this.observe)"childList"!==e?this.callbackMap.has(t)?this.callbackMap.get(t)[e]?this.callbackMap.get(t)[e].push(this.callback):this.callbackMap.get(t)[e]=[this.callback]:this.callbackMap.set(t,{[e]:[this.callback]}):this.callbackMap.get("ALL").childList&&this.callbackMap.get("ALL").childList.push(this.callback)},r.prototype.uninit=function(t){for(let[e,n]of this.callbackMap.entries())n.attributes&&(n.attributes=n.attributes.filter((e=>e!==t))),n.characterData&&(n.characterData=n.characterData.filter((e=>e!==t))),n.addedNodes&&(n.addedNodes=n.addedNodes.filter((e=>e!==t))),n.removedNodes&&(n.removedNodes=n.removedNodes.filter((e=>e!==t))),n.childList&&(n.childList=n.childList.filter((e=>e!==t))),this.callbackMap.set(e,{attributes:n.attributes,characterData:n.characterData,addedNodes:n.addedNodes,removedNodes:n.removedNodes,childList:n.childList})},r.prototype._callback=function(t){for(let e of t)switch(window.counter++,e.type){case"attributes":this._attributeCallback(e);break;case"characterData":this._characterDataCallback(e);break;case"childList":this._childListCallback(e)}},r.prototype.runCallbackGen=function(t){return[function(e,n){let r=this.callbackMap.get(n);if(r&&r[t])for(let n of r[t])n(e)},function(e){for(let n of this.callbackMap.get("ALL")[t])n(e)}]},r.prototype._attributeCallback=function(t){if(!t.target.hasAttributes(t.attributeName))return;t.target.getAttribute(t.attributeName)!==t.oldValue&&(this.runCallbackAtt(t,t.attributeName),this.runCallbackAttAll(t))},r.prototype._characterDataCallback=function(t){if(t.target.data===t.oldValue)return;this.runCallbackCharAll(t);let e=t.target.parentElement;for(let n of e.attributes)this.runCallbackChar(t,n.name)},r.prototype.runCallbackExGen=function(t,e){return function n(r){for(let i of r[e]){if(i.tagName)for(let e of i.attributes){let n=this.callbackMap.get(e.name);if(n&&n[t])for(let e of n[t])e({type:r.type,target:i,[t]:!0})}i.children&&n.call(this,{[e]:i.children})}for(let n of this.callbackMap.get("ALL")[t])for(let i of r[e])i.tagName&&n({type:r.type,target:i,[t]:!0})}},r.prototype._childList=function(t){this.callbackMap.get("ALL").childList.forEach((e=>{e(t)}))},r.prototype._childListCallback=function(t){this._childList(t),this.runCallbackAdd(t),this.runCallbackRemove(t)},r.prototype.setInitialized=function(t,e){t["co_initialized_"+(e=e||"")]=!0},r.prototype.getInitialized=function(t,e){return!!t["co_initialized_"+(e=e||"")]};const o=new r(document.body)},446:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(t){function e(){let e={};return t&&t.config&&(e=t.config),{apiKey:e.apiKey,organization_id:e.organization_Id}}function n(e){let n={};return t&&t.config&&(n=t.config),{apiKey:e.apiKey||n.apiKey,organization_id:e.organization_id||n.organization_Id}}function r(e,n){let r={};t&&t.config&&(r=t.config);let i=e||r.organization_Id,o=n||"";return o?`${i}/${o}`:i}return{getCommonParams:e,getCommonParamsExtend:n,generateSocketClient:r}}(window)}.apply(e,[]))||(t.exports=n)},585:function(t,e,n){var r,i;"undefined"!=typeof self&&self,r=[n(446),n(212)],void 0===(i=function(t,e){return function(t,e,n,r,i){class o{constructor(t="crud"){this.prefix=t||"crud",this.sockets=new Map,this.listeners=new Map,this.messageQueue=new Map,this.saveFileName="",this.globalScope=""}setGlobalScope(t){this.globalScope=`${this.prefix}/${t}`}getGlobalScope(){return this.globalScope}create(t){const{namespace:i,room:o}=t,a=this.getKey(i,o);let l,s=this;if(i&&this.setGlobalScope(i),this.sockets.get(a))return void(l=this.sockets.get(a));let d=e.location.protocol;"about:"===e.location.protocol&&(d=e.parent.location.protocol,t.host||(t.host=e.parent.location.host));let c="http:"===d?"ws":"wss";const u=t.port?t.port:8088;let h=`${c}://${e.location.host}:${u}/${a}`;t.host&&(h=t.host.includes("://")?`${t.host}/${a}`:t.host.includes(":")?`${c}://${t.host}/${a}`:`${c}://${t.host}:${u}/${a}`);try{let t=null;e.localStorage&&(t=e.localStorage.getItem("token")),l=new n(h,t),l.cocreate_connected=!1,this.sockets.set(a,l)}catch(t){return}l.onopen=function(t){l.cocreate_connected||(l.cocreate_connected=!0),(s.messageQueue.get(a)||[]).forEach((t=>l.send(JSON.stringify(t)))),s.messageQueue.set(a,[])},l.onclose=function(e){switch(e.code){case 1e3:break;default:s.destroy(l,a),s.reconnect(l,t)}},l.onerror=function(e){s.destroy(l,a),s.reconnect(l,t)},l.onmessage=function(t){try{if(e.Blob&&t.data instanceof r)return void s.saveFile(t.data);let n=JSON.parse(t.data);if(n.data&&(n.data.uid&&s.__fireEvent(n.data.uid,n.data),n.data.event))return void s.__fireEvent(n.data.event,n.data);n.action;const i=s.listeners.get(n.action);if(!i)return;i.forEach((t=>{t(n.data,a)}))}catch(t){}}}__fireEvent(t,n){if(e.CustomEvent){var r=new e.CustomEvent(t,{detail:n});e.document.dispatchEvent(r)}else process.emit(t,n)}send(t,e,n){const r=i.generate(),o={action:t,data:{...e,uid:r}},a=this.getKeyByRoom(n),l=this.getByRoom(n);return l&&l.cocreate_connected?l.send(JSON.stringify(o)):this.messageQueue.get(a)?this.messageQueue.get(a).push(o):this.messageQueue.set(a,[o]),r}sendFile(t,e){const n=this.getByRoom(e);n&&n.send(t)}listen(t,e){this.listeners.get(t)?this.listeners.get(t).push(e):this.listeners.set(t,[e])}reconnect(t,e){let n=this;setTimeout((function(){n.create(e)}),1e3)}destroy(t,e){t&&(t.onerror=t.onopen=t.onclose=null,t.close(),t=null),this.sockets.get(e)&&this.sockets.delete(e)}destroyByKey(t){let e=this.sockets.get(t);e&&this.destroy(e,t)}getKey(t,e){let n=`${this.prefix}`;return t&&""!=t&&(n+=e&&""!=e?`/${t}/${e}`:`/${t}`),n}getByRoom(t){let e=this.getKeyByRoom(t);return this.sockets.get(e)}getKeyByRoom(t){let e=this.globalScope;return t&&(e=`${this.prefix}/${t}`),e}saveFile(t){if(e.document){const r=this.saveFileName||"downloadFile";var n=e.document.createElement("a");e.document.body.appendChild(n),n.style="display: none";let i=window.URL.createObjectURL(t);n.href=i,n.download=r,n.click(),e.URL.revokeObjectURL(i),this.saveFileName=""}}listenAsync(t){return new Promise(((n,r)=>{let i=setTimeout((()=>{clearTimeout(i),n(null)}),5e3);e.document?e.document.addEventListener(t,(function(t){n(t.detail)}),{once:!0}):process.once(t,(t=>{n(t)}))}))}}return o}(0,window,WebSocket,Blob,e)}.apply(e,r))||(t.exports=i)},727:(t,e,n)=>{"use strict";function r(t,e,n){if(e){if(t.classList.contains(e))return t;let n=t.parentNode;for(;null!=n&&n.classList;){if(n.classList.contains(e))return n;n=n.parentNode}}else if(n){if(n.every((e=>t.attributes.hasOwnProperty(e))))return t;let e=t.parentNode;for(;null!=e&&e.attributes;){if(n.every((t=>e.attributes.hasOwnProperty(t))))return e;e=e.parentNode}}return!1}function i(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function o(t){return t.getAttributeNames().reduce(((e,n)=>(e[n]=t.getAttribute(n),e)),{})}function a(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function l(t,e){try{if(void 0===t)return!1;let n=e.split("."),r=n.shift();return n.length>0?this.__getValueFromJonDeep(t[r],n.join(".")):t[r]}catch(t){return!1}}function s(t){let e=[{document,window}];for(let t of document.querySelectorAll("iframe")){let n=t.contentDocument||t.contentWindow.document,r=t.contentWindow;e.push({document:n,window:r,frameElement:t})}let n=new Set;for(let r of e){let e=t(r);e&&"function"==typeof e[Symbol.iterator]?e.forEach((t=>n.add(t))):e&&n.add(e)}return Array.from(n)}function d(t){let e=[];do{if(!t||!t.tagName)return!1;let n=t.tagName.toLowerCase();if(t.id&&"BODY"!==t.tagName&&(n+="#"+t.id),t.classList.length&&"BODY"!==t.tagName&&t.classList.forEach((t=>{-1===t.indexOf(":")&&(n+="."+t)})),"BODY"!==t.tagName&&t.parentNode){let e=Array.prototype.indexOf.call(t.parentNode.children,t);n+=`:nth-child(${e+1})`}e.unshift(n),t=t.parentNode}while("HTML"!==t.tagName);return e.join(" > ")}function c(){let t=window;for(;t!==window.parent;)t=window.parent;return t}function u(t,e){let n;return s((t=>{t.document.contains(e)&&(n=t.frameElement)})),n}function h(t){let e=c;return t.forEach((t=>{e&&(e=e.querySelector(t))})),e}function*f(t,e){for(let n of t)n.selector&&e.matches(n.selector)&&(yield n)}function p(t,e,n,r){for(let i of f(r||window.elementConfig,t)){if(!0===i[e])return n(t,i);if(!1===i[e])return!1;if(void 0===i[e])continue;if(w(i[e]))return n(t,i,!0)}return!1}function g(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head.children[0]?e.head.children[0]:e.body.children[0]}function m(t,e){return t.split(e).map((t=>t.trim()))}function b(t,e){return t.map((t=>t.trim())).join(e)}function w(t){try{document.createDocumentFragment().querySelector(t)}catch(t){return!1}return!0}function y(t,e){let n=[],r=(window,u(0,t)),i=d(r);return i&&n.unshift(i),e?{path:n,document:r||document}:n}function v(t="all"){if(!["all","error","warn","log","off"].includes(t))throw new Error("level must be one of all, error, warn, log or off");return{error:function(e){["all","error"].includes(t)},warn:function(e){["all","error","warn"].includes(t)},log:function(){["all","error","warn","log"].includes(t)}}}async function E(t){if("loading"===t.contentDocument.readyState)try{await new Promise(((e,n)=>{t.contentWindow.addEventListener("load",(t=>e()))}))}catch(t){}}function A(t,e){let n=e.split(";"),r=t;for(let t=0;t<n.length-1;t++)if(r=r.querySelector(n[t]),!r)return[];return[this,[n.length-1]]}function k(t){let[e,n]=A(this,t);return e?e.contentWindow.document.querySelector(n):null}function x(t){let[e,n]=A(this,t);return e?e.contentWindow.document.querySelectorAll(n):[]}n.r(e),n.d(e,{getParentFromElement:()=>r,isJsonString:()=>i,getAttributes:()=>o,checkAttrValue:()=>a,getValueFromJonDeep:()=>l,allFrame:()=>s,cssPath:()=>d,getTopMostWindow:()=>c,findIframeFromElement:()=>u,getIframeFromPath:()=>h,configMatch:()=>f,configExecuter:()=>p,parseTextToHtml:()=>g,splitBydelimiter:()=>m,joinBydelimiter:()=>b,isValidSelector:()=>w,getElementPath:()=>y,logger:()=>v,waitForLoad:()=>E,getComplexSelector:()=>A,frameQuerySelector:()=>k,frameQuerySelectorAll:()=>x,default:()=>C});const C={getElementPath:y,isValidSelector:w,joinBydelimiter:b,splitBydelimiter:m,parseTextToHtml:g,configExecuter:p,configMatch:f,getIframeFromPath:h,findIframeFromElement:u,getTopMostWindow:c,cssPath:d,allFrame:s,checkAttrValue:a,getAttributes:o,isJsonString:i,getParentFromElement:r,logger:v}},212:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(t){const e={attribute:"data-uuid",init:function(e){if(!t.document)return;const n=e||t.document;if(!n.querySelectorAll)return;let r=n.querySelectorAll(`[${this.attribute}]`);const i=this;r.forEach((t=>{const e=parseInt(t.getAttribute(i.attribute))||36,n=i.generate(e);"INPUT"===t.tagName||"TEXTAREA"===t.tagName?t.value=n:t.innerHTML=n}))},generate:function(e=36){let n=(new Date).getTime(),r=t.performance&&t.performance.now&&1e3*t.performance.now()||0,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(e<=i.length)i=i.substr(0,e);else{let t=e-i.length,n="-xxxyyxxx",r=Math.floor(t/n.length);for(let t=0;t<r;t++)i+=n;r=t-r*n.length,i+=n.substr(0,r)}return i.replace(/[xy]/g,(function(t){var e=16*Math.random();return n>0?(e=(n+e)%16|0,n=Math.floor(n/16)):(e=(r+e)%16|0,r=Math.floor(r/16)),("x"==t?e:7&e|8).toString(16)}))}};return e.init(),e}(window)}.apply(e,[]))||(t.exports=n)},442:(t,e,n)=>{"use strict";var r=o(n(727)),i=o(n(980));function o(t){return t&&t.__esModule?t:{default:t}}window.parent===window&&(window.addEventListener("load",(()=>{i.default.listen("domEditor",(function(t){if(t.target&&(t.target=document.querySelector(`[data-element_id="${t.target}"]`)),t.value[1]&&(t.value[1]=document.querySelector(`[data-element_id="${t.value[1]}"]`)),!t.target)return;if(!t.value[1])return;let[e,n]=t.value;t.target.insertAdjacentElement(e,n)})),i.default.listen("dndNewElement",(function(t){try{if(t.path.length){let e=document.querySelector(t.path[0]),n=e.contentWindow.document||e.contentDocument;t.target=n.querySelector(`[data-element_id=${t.target}]`)}else t.target=document.querySelector(`[data-element_id=${t.target}]`);if(t.value[1]=r.default.parseTextToHtml(t.value[1]),t.hiddenAttribute)for(let[e,n]of Object.entries(t.hiddenAttribute))t.value[1].setHiddenAttribute(e,n);let[e,n]=t.value;t.target.insertAdjacentElement(e,n)}catch(t){}}))})),window.addEventListener("dndsuccess",(t=>{let{dropedEl:e,dragedEl:n,position:o,dropType:a,path:l}=t.detail;if(n.ownerDocument!==e.ownerDocument?window.iframes.guests.canvas.window.CoCreate:window.CoCreate,e.getAttribute("data-element_id")||e.setAttribute("data-element_id",r.default.UUID()),e=e.getAttribute("data-element_id"),"data-cloneable"===a){let t=n.getAllHiddenAttribute();n=n.outerHTML,i.default.send({broadcast_sender:!1,rooms:"",emit:{message:"dndNewElement",data:{target:e,method:"insertAdjacentElement",value:[o,n],path:l,hiddenAttribute:t}}})}else n.getAttribute("data-element_id")||n.setAttribute("data-element_id",r.default.UUID()),n=n.getAttribute("data-element_id"),i.default.send({broadcast_sender:!0,rooms:"",emit:{message:"domEditor",data:{target:e,method:"insertAdjacentElement",value:[o,n]}}})})))},586:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){o.default.init({name:"dnd-config",observe:["addedNodes"],callback:t=>{let e=t.target;e.classList.contains("sortable")&&e.classList.contains("cloneable")&&l(t.target.parentElement.parentElement)}}),l(document)};var r,i=n(352),o=(r=n(366))&&r.__esModule?r:{default:r};let a=(0,n(727).logger)("off");function l(t){a.log("dnd domReader init ",(new Date).getSeconds()+" "+(new Date).getMilliseconds()),t.querySelectorAll(".sortable").forEach((t=>{a.log("dnd config sortable",t),(0,i.initContainer)({target:t})})),t.querySelectorAll(".cloneable").forEach((t=>{a.log("dnd config cloneable",t),(0,i.initContainer)({target:t,cloneable:!0})}))}},197:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.listener={},this.on=function(t,e){Object.hasOwnProperty(t)||(this.listener[t]=[]),this.listener[t].push(e)},this.dispatch=function(t,e){this.listener.hasOwnProperty(t)&&this.listener[t].forEach((t=>t(e)))}}},352:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.initIframe=e.initFunction=e.initElement=e.initContainer=void 0,n(442);var r=d(n(586));n(493);var i=n(155),o=d(n(492));n(591);var a=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=s(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}r.default=t,n&&n.set(t,r);return r}(n(996));n(127);var l=d(n(825));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(s=function(t){return t?n:e})(t)}function d(t){return t&&t.__esModule?t:{default:t}}let c,u,h,f,p,g=(0,n(727).logger)("off");let m,b,w={scroller:new i.autoScroller({speed:4,threshold:3}),myDropMarker:new i.dropMarker},{myDropMarker:y,scroller:v}=w,E=new o.default((function(){return u?u.apply(null,arguments):{}}));E.on("dragStart",(t=>{y.hide(),m=new i.ghostEffect(t.e,t.el,{window,document}),m.start()})),E.on("dragEnd",(t=>{y.hide(),m&&m.hide(t.ref)})),E.on("dragOver",(t=>{y.draw(t.el,t.closestEl,t.orientation,!!t.hasChild,t.ref)}));let A=!1;function k(t,e){let n=(0,i.getCocs)(t.target,[a.draggable,a.cloneable,a.handleable]);if(!Array.isArray(n))return;let[r,o]=n;switch(o){case a.cloneable:let t=r.getAttribute(a.data_insert_html);if(t){if(r=(0,i.parse)(t),!r)return}else r=r.cloneNode(!0);break;case a.draggable:if(r.getAnyAttribute(a.handleable))return;break;default:r=(0,i.getCoc)(r,a.draggable)}let l=(0,i.getGroupName)(r);b=l[1],e.document.body.style.cursor="crosshair !important",A=!0,E.dragStart(t,r,null,e,o)}function x(t,e){e.document.body.style.cursor="",A=!1,E.dragEnd(t),y.hide(),v.deactivateScroll()}function C({x:t,y:e,target:n,isTouch:r},o,l){if(!A)return;if(m&&m.draw({x:t,y:e},o),v.update(t,e),A){let[t,e]=(0,i.getGroupName)(n);if(b&&e){if(b!==e)for(;;){let r=(0,i.getGroupName)(t);if(!r[0])return;if(t=r[0].parentElement,e=r[1],b===e){n=r[0];break}}}else if(b!==e)return}else m&&m.hide();if(!n)return;let s=(0,i.getCoc)(n,a.droppable);s&&(l||v.calculateScroll({x:t,y:e,element:s.parentElement,onMouseScrollMove:t=>C(t,o,!0)}),E.dragOver({x:t,y:e,target:s},s,o))}p=(t,e)=>{1==t.which&&k(t,e)},f=(t,e)=>{1==t.which&&x(t,e)},h=(t,e)=>{C(t,e)};let S=new Map;const M=({isIframe:t,frame:e,document:n,window:r})=>{let o,s,d,u,m,b,w;if(t){let t=e.contentWindow,n=t.document||e.contentDocument,r=e.getBoundingClientRect();o={x:r.left,y:r.top,frame:e,window:t,document:n,isIframe:!0}}else o={x:0,y:0,window:r,document:n,isIframe:!1};if(l.default.register(o.window),!o.window.CoCreateDnd||!o.window.CoCreateDnd.hasInit){if(!o.document.querySelector("#dnd-style")){let t=o.document.createElement("style");t.id="dnd-style",t.innerHTML='    /* dnd specic */\n      [data-draggable="true"], [data-cloneable="true"]  {\n        touch-action: none;\n      }\n      /* dnd specic */',o.document.head.append(t)}o.document.addEventListener("dragstart",(t=>(t.preventDefault(),!1))),o.document.addEventListener("selectstart",(t=>{let e=(0,i.getCocs)(t.target,[a.draggable,a.cloneable]);Array.isArray(e)&&t.preventDefault()}),{passive:!1}),S.has(o.window)?({mousemovee:s,mouseupe:d,mousedowne:u,touchmovee:m,touchheade:b,touchstarte:w}=S.get(o.window)):(w=function(t){c&&clearTimeout(c),c=setTimeout((()=>{g.log("touch start"),o.document.body.style.touchAction="none",t.preventDefault(),k(t,o)}),1e3)},b=function(t){o.document.body.style.touchAction="auto",A?(t.preventDefault(),x(t,o)):c&&clearTimeout(c)},m=function(t){if(!A)return c&&clearTimeout(c),void g.log("touch scroll");g.log("touch dnd"),t.preventDefault();let e=t.touches[0],n=e.clientX,r=e.clientY,i=o.document.elementFromPoint(n,r);i&&C({x:n,y:r,target:i,isTouch:!0},o)},u=function(t){p.apply(this,[t,o])},d=function(t){f.apply(this,[t,o])},s=function(t){h.apply(this,[t,o])},S.set(o.window,{mousemovee:s,mouseupe:d,mousedowne:u,touchmovee:m,touchheade:b,touchstarte:w})),o.document.removeEventListener("touchstart",w),o.document.addEventListener("touchstart",w),o.document.removeEventListener("touchend",b,{passive:!1}),o.document.addEventListener("touchend",b,{passive:!1}),o.document.removeEventListener("touchmove",m,{passive:!1}),o.document.addEventListener("touchmove",m,{passive:!1}),o.document.removeEventListener("mousedown",u),o.document.addEventListener("mousedown",u),o.document.removeEventListener("mouseup",d),o.document.addEventListener("mouseup",d),o.document.removeEventListener("mousemove",s),o.document.addEventListener("mousemove",s)}};e.initIframe=M,window.addEventListener("load",(()=>{window.parent===window&&(M({document,window}),(0,r.default)())}));const _=function({target:t,onDnd:e,onDndSuccess:n}){"function"==typeof n&&(u=n),i.initFunctionState.push({target:t,onDnd:e})};e.initFunction=_;const L=function({target:t,dropable:e,draggable:n,cloneable:r,handle:i,group:o,exclude:l,beforeDndSuccess:s}){try{if("function"==typeof s&&(u=s),o&&t.setHiddenAttribute(a.group_name,o),l)try{t.querySelectorAll(l).forEach((t=>{t.setHiddenAttribute(a.exclude,"true")}))}catch(t){if(t instanceof HTMLElement){let t="Dnd Sortable: exclude must be valid selector";g.error(t)}throw t}e&&t.querySelectorAll(e).forEach((t=>{t.setHiddenAttribute(a.droppable,"true")})),n&&t.querySelectorAll(n).forEach((t=>{t.setHiddenAttribute(a.draggable,"true")})),r&&t.querySelectorAll(r).forEach((t=>{t.setHiddenAttribute(a.cloneable,"true")}))}catch(t){if(t instanceof DOMException){let e="Dnd Sortable: handle must be a valid selector";throw g.error(e),t}throw t}};function D(t,e){t.children.length&&Array.from(t.children).forEach((t=>{D(t),t.setHiddenAttribute(a.exclude,"true"),t.setHiddenAttribute(a.draggable,"true"),e&&t.setHiddenAttribute(a.cloneable,"true")}))}e.initElement=L;const N=function({target:t,cloneable:e=!1,nested:n=!1,handle:r,group:i,exclude:o}){if(i&&t.setHiddenAttribute(a.group_name,i),o)try{t.querySelectorAll(o).forEach((t=>{t.setHiddenAttribute(a.exclude,"true")}))}catch(t){if(t instanceof DOMException){let t="Dnd Sortable: exclude must be valid selector";throw g.error(t),t}throw t}if(!t.tagName){let t="Dnd Sortable: Please provide a valid element";throw g.error(t),t}if("boolean"!=typeof e){let t="Dnd Sortable: please provide valid data type for cloneable";throw g.error(t),t}if("boolean"!=typeof n){let t="Dnd Sortable: please provide valid data type for nested";throw g.error(t),t}n?D(t,e):(t.setHiddenAttribute(a.droppable,"true"),g.log("dnd loaded target child",t.children),t.children.length&&Array.from(t.children).forEach((t=>{e?t.setHiddenAttribute(a.cloneable,"true"):(g.log("dnd loaded draggable",t),t.setHiddenAttribute(a.draggable,"true"));try{let e=t.querySelectorAll(r);r&&e.length&&(t.setHiddenAttribute(a.draggable,"true"),e.forEach((t=>{t.setHiddenAttribute(a.draggable,"true")})))}catch(t){if(t instanceof DOMException){let t="Dnd Sortable: handle must be a valid selector";throw g.error(t),t}throw t}})))};e.initContainer=N;let O={initContainer:N,initElement:L,initFunction:_};var j={initIframe:M,init:function(t){let{mode:e}=t;if(delete t.mode,!["function","element","container"].includes(e))throw new Error("invalid mode provided");let n="init"+e.charAt(0).toUpperCase()+e.slice(1);O[n].apply(null,[t])}};e.default=j},155:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCoc=function(t,e){t.tagName||(t=t.parentElement);return a.getContext(t,e)},e.getCocs=function(t,e){t.tagName||(t=t.parentElement);return a.getContexts(t,e)},e.getGroupName=function(t){t.tagName||(t=t.parentElement);for(;;){let e=t.getAttribute(r.group_name);if(e)return[t,e];if(!(t=t.parentElement))return[null,void 0]}},e.computeStyles=s,e.randomId=function(){return window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16)},e.dropMarker=function(t){t=Object.assign({borderSize:2,dropMarkerMargin:5},t);let e=document.createElement("div");e.id="dropMarker",e.style.pointerEvents="none",this.lastOrigntaion=void 0,document.body.append(e),this.obj=e,this.draw=function(n,r,i,o,a){e.style.display="block";let l,s=r.getBoundingClientRect();switch(s.width||s.height||(s=n.getBoundingClientRect(),i="top"),i){case"top":case"bottom":e.style.height=t.borderSize+"px",e.style.width=s.width+"px";break;case"left":case"right":e.style.width=t.borderSize+"px",e.style.height=s.height+"px";break;default:throw new Error("one type of orientation must be specified")}if(n!=r){let e=n.getBoundingClientRect()[i],r=s[i];Math.abs(e-r)<2*t.dropMarkerMargin&&(o=!0)}switch(l=a.frame?a.frame.getBoundingClientRect():{top:0,left:0},e.style.transition="top,left 0.2s ease-in-out",i){case"top":e.style.top=l.top+s.top-t.borderSize/2+window.scrollY+(o?t.dropMarkerMargin:-t.dropMarkerMargin)+"px",e.style.left=l.left+s.left-t.borderSize/2+window.scrollX+"px";break;case"bottom":e.style.top=l.top+s.bottom-t.borderSize/2+window.scrollY+(o?-t.dropMarkerMargin:t.dropMarkerMargin)+"px",e.style.left=l.left+s.left-t.borderSize/2+window.scrollX+"px";break;case"left":e.style.top=l.top+s.top-t.borderSize/2+window.scrollY+"px",e.style.left=l.left+s.left-t.borderSize/2+window.scrollX+(o?t.dropMarkerMargin:-t.dropMarkerMargin)+"px";break;case"right":e.style.top=l.top+s.top-t.borderSize/2+window.scrollY+"px",e.style.left=l.left+s.right-t.borderSize/2+window.scrollX+(o?-t.dropMarkerMargin:t.dropMarkerMargin)+"px";break;default:throw new Error("one type of orientation must be specified")}this.lastOrigntaion=i},this.hide=function(t){e.style.display="none"}},e.parse=function(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head.children[0]?e.head.children[0]:e.body.children[0]},e.ghostEffect=function(t,e,n){this.effectCb,e.removeAttribute("CoC-dragging"),this.start=()=>{this.cloneEl=e.cloneNode(!0);let{width:t,height:r}=n.window.getComputedStyle(e);window.getComputedStyle(this.cloneEl);this.wrapper=document.createElement("div"),this.wrapper.style.height=r,this.wrapper.style.width=t,this.wrapper.append(this.cloneEl),this.wrapper.style.display="none",n.document.body.append(this.wrapper),this.wrapper.style.pointerEvents="none",this.wrapper.id="ghostEffect"},this.draw=(e,n)=>{this.wrapper.style.display="block";this.wrapper.getBoundingClientRect();let r,{marginTop:i,marginBottom:o,marginLeft:a,marginRight:l,width:d,height:c}=s(this.cloneEl,["marginTop","marginBottom","marginLeft","marginRight","width","height"]);r=n.frame?n.frame.getBoundingClientRect():{top:0,left:0},this.wrapper.style.top=r.top+e.y-t.offsetY+"px",this.wrapper.style.left=r.left+e.x-t.offsetX+"px"},this.hide=()=>{this.wrapper.remove()}},e.pDistance=d,e.closestChild=function(t,e){let n,r,i=1/0;for(let o of e){if(o.classList.contains("hidden"))continue;let[e,a]=u(t,o);a<i&&(i=a,n=o,r=e)}return[r,n]},e.distanceToChild=u,e.distanceToChildLeftRight=h,e.distanceToChildTopBottom=f,e.autoScroller=function({speed:t,threshold:e}){this.lastScrollingElement,this.onElement,this.mouse,this.speed,this.interval,this.isActive,this.update=function(t,e){this.mouse={x:t,y:e}},this.calculateScroll=function({x:n,y:r,element:i,onMouseScrollMove:o}){for(;!(i&&i.tagName&&(i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth))&&i.parentElement;)i=i.parentElement;let a=i.scrollWidth>i.clientWidth,l=i.scrollHeight>i.clientHeight,s=i.clientWidth/e,d=i.clientHeight/e,[c,u]=[];if(l?[c,u]=f([n,r],i):a&&([c,u]=h([n,r],i)),c){let e;switch(c){case"top":case"bottom":this.speed=d/(u+1)*t,e=u<d;break;case"left":case"right":this.speed=s/(u+1)*t,e=u<s}e?this.isActive?this.isActive&&this.lastScrollingElement!==i&&(this.deactivateScroll(i),this.__activateScroll(i,c,o)):(this.isActive=!0,this.__activateScroll(i,c,o)):this.isActive&&(this.isActive=!1,this.deactivateScroll(i))}},this.__activateScroll=function(t,e,n){t.style.scrollBehavior="auto",this.lastScrollingElement=t,this.interval=setInterval((()=>{switch(e){case"top":t.scrollBy(0,-this.speed);break;case"bottom":t.scrollBy(0,this.speed);break;case"left":t.scrollBy(-this.speed,0);break;case"right":t.scrollBy(this.speed,0)}}),10)},this.deactivateScroll=function(t){t&&(t.style.scrollBehavior=""),clearInterval(this.interval)}},Object.defineProperty(e,"initFunctionState",{enumerable:!0,get:function(){return i.initFunctionState}}),e.dndContext=void 0;var r=n(996),i=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=o(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var l=i?Object.getOwnPropertyDescriptor(t,a):null;l&&(l.get||l.set)?Object.defineProperty(r,a,l):r[a]=t[a]}r.default=t,n&&n.set(t,r);return r}(n(612));function o(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(o=function(t){return t?n:e})(t)}let a,l=window;for(;l!==window.parent;)l=window.parent;function s(t,e){let n=window.getComputedStyle(t),r={};return e.forEach((t=>{r[t]=parseInt(n[t])})),r}e.dndContext=a,l.dndContext?e.dndContext=a=l.dndContext:(e.dndContext=a=new i.default,l.dndContext=a);function d(t,e,n,r,i,o){var a,l,s=i-n,d=o-r,c=s*s+d*d,u=-1;0!=c&&(u=((t-n)*s+(e-r)*d)/c),u<0?(a=n,l=r):u>1?(a=i,l=o):(a=n+u*s,l=r+u*d);var h=t-a,f=e-l;return Math.sqrt(h*h+f*f)}let c=["left","top","right","bottom"];function u(t,e){let n,r=e.getBoundingClientRect(),i={p1:[r.top,r.left],p2:[r.bottom,r.left]},o={p1:[r.top,r.left],p2:[r.top,r.right]},a={p1:[r.top,r.right],p2:[r.bottom,r.right]},l={p1:[r.bottom,r.left],p2:[r.bottom,r.right]},s=[d(t[0],t[1],i.p1[1],i.p1[0],i.p2[1],i.p2[0]),d(t[0],t[1],o.p1[1],o.p1[0],o.p2[1],o.p2[0]),d(t[0],t[1],a.p1[1],a.p1[0],a.p2[1],a.p2[0]),d(t[0],t[1],l.p1[1],l.p1[0],l.p2[1],l.p2[0])],u=1/0;return s.forEach(((t,e)=>{t<u&&(u=t,n=c[e])})),[n,u]}function h(t,e){let n,r=e.getBoundingClientRect(),i={p1:[r.top,0],p2:[r.bottom,0]},o={p1:[r.top,e.clientWidth],p2:[r.bottom,e.clientWidth]},a=[d(t[0],t[1],i.p1[1],i.p1[0],i.p2[1],i.p2[0]),d(t[0],t[1],o.p1[1],o.p1[0],o.p2[1],o.p2[0])],l=1/0;return a.forEach(((t,e)=>{t<l&&(l=t,n=["left","right"][e])})),[n,l]}function f(t,e){let n,r=e.getBoundingClientRect(),i={p1:[0,r.left],p2:[0,r.right]},o={p1:[e.clientHeight,r.left],p2:[e.clientHeight,r.right]},a=[d(t[0],t[1],i.p1[1],i.p1[0],i.p2[1],i.p2[0]),d(t[0],t[1],o.p1[1],o.p1[0],o.p2[1],o.p2[0])],l=1/0;return a.forEach(((t,e)=>{t<l&&(l=t,n=["top","bottom"][e])})),[n,l]}},612:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){this.map=new Map,this.checkInitFunction=function(t,e){for(let r of n)if(r.target.contains(t)){let n=r.onDnd(t,e);if(Array.isArray(n))return n}},this.getContext=function(t,e){do{if("true"==t.getAnyAttribute(e))return t;if(this.checkInitFunction(t,[e]))return t;t=t.parentElement}while(t)},this.getContexts=function(t,e){do{for(let n of e){if("true"==t.getAnyAttribute(n))return[t,n];{let n=this.checkInitFunction(t,e);if(Array.isArray(n)&&e.includes(n[1]))return n}}t=t.parentElement}while(t)},this.setContext=function(t,e,n){t.setHiddenAttribute(e,n)}},e.initFunctionState=void 0;let n=[];e.initFunctionState=n},825:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;let r=(0,n(727).logger)("off");let i=new function(t){this.state=t,this.removeAttribute=(t,e)=>{this.state.has(t)&&delete this.state.get(t).attributes[e]},this.hasAttribute=(t,e)=>{if(this.state.has(t))return!!this.state.get(t).attributes[e]},this.getAttribute=(t,e)=>{if(this.state.has(t))return this.state.get(t).attributes[e]},this.setAttribute=(t,e,n)=>{this.state.has(t)?this.state.get(t).attributes[e]=n:this.state.set(t,{element:t,attributes:{[e]:n}})},this.getAllAttributes=t=>{if(this.state.has(t))return this.state.get(t).attributes},this.getDataset=t=>{let e={};for(let[n,r]of Object.entries(this.state.get(t).attributes))n.beginsWith("data-")&&(e[n.substr(5)]=r);return e}}(new Map);function o(t,e=i){let n=t.Element.prototype;if(n.setHiddenAttribute)return;let o=n.setAttribute;n.setAttribute=function(t,e){o.apply(this,[t,e])},n.setHiddenAttribute=function(t,n){r.log("dnd domReader ",(new Date).getSeconds()+" "+(new Date).getMilliseconds()),e.setAttribute(this,t,n)},n.getHiddenAttribute=function(t){return e.getAttribute(this,t)},n.getAllHiddenAttribute=function(t){return e.getAllAttributes(this)},n.getAnyAttribute=function(t){return this.hasAttribute(t)?this.getAttribute(t):e.hasAttribute(this,t)?e.getAttribute(this,t):void 0},n.setAnyAttribute=function(t,n){this.setAttribute(t,n),e.setAttribute(this,t,n)},n.removeAnyAttribute=function(t){this.removeAnyAttribute(t),e.removeAttribute(this,t)},n.hasAnyAttribute=function(t,n){return this.hasAttribute(t)||e.hasAttribute(this,t)},n.hideAttribute=function(t){if(this.hasAttribute(t)){if(e.hasAttribute(this,t))return!1;e.setAttribute(this,t,this.getAttribute(t)),this.removeAttribute(t)}},n.unhideAttribute=function(t){if(e.hasAttribute(this,t)){if(this.hasAttribute(t))return!1;this.setAttribute(t,e.getAttribute(this,t)),e.removeAttribute(this,t)}}}window.domContext=i,function(){let t=Array.from(window.frames);t.unshift(window);for(let e of t)o(e.window)}();var a={register:o,domContext:i};e.default=a},493:()=>{"use strict";window.addEventListener("load",(()=>{let t={host:{document,window},guests:{}};window.iframes=t;let e=document.getElementsByTagName("iframe"),n=1;for(let r of e){let e=r.id||"iframe"+n++;t.guests[e]={frame:r,document:r.contentDocument,window:r.contentWindow},r.contentWindow.iframes=t}new MutationObserver((function(e,r){for(let r of e)if("childList"===r.type)for(let e of r.addedNodes)if("IFRAME"===e.tagName){let r=e.id||"iframe"+n++;t.guests[r]={frame:e,document:e.contentDocument,window:e.contentWindow},e.contentWindow.iframes=t}})).observe(document.body,{attributes:!0,childList:!0,subtree:!0})}))},591:()=>{"use strict";let t=null,e=null;document.addEventListener("mousedown",(n=>{1===n.which&&(t=n.target,e=(new Date).getTime())})),document.addEventListener("mouseup",(n=>{let r=(new Date).getTime();if(t==n.target&&r<e+500){const t=new CustomEvent("CoCreateClickLeft",{bubbles:!0});n.target.dispatchEvent(t)}}))},996:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.data_insert_html=e.group_name=e.dndname=e.handleable=e.hoverable=e.editable=e.selectable=e.cloneable=e.draggable=e.exclude=e.droppable=void 0;e.droppable="data-droppable";e.exclude="data-exclude";e.draggable="data-draggable";e.cloneable="data-cloneable";e.selectable="data-selectable";e.editable="data-editable";e.hoverable="data-hoverable";e.handleable="data-handle";e.dndname="data-name";e.group_name="data-group_name";e.data_insert_html="data-insert-html"},492:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){this.dragedEl,this.dropedEl,this.position,this.id,this.type;let e=new r.default;this.on=function(){e.on.apply(e,arguments)},this.dragStart=(t,n,r,i,o)=>{this.id=r,this.dropType=o,this.dragedEl=n,e.dispatch("dragStart",{e:t,el:n,ref:i})},this.dragEnd=(n,r)=>{try{if(this.dragedEl&&this.dragedEl.removeAttribute("CoC-dragging"),this.position){if(this.dropedEl===this.dragedEl)throw"dnd cancelled. you can't dnd on the same element.";if(this.dragedEl.contains(this.dropedEl))throw"dnd cancelled, you can't dnd from parent to its children.";let e,n=o.default.getElementPath(this.dropedEl),r={position:this.position,dragedEl:this.dragedEl,dropedEl:this.dropedEl,dropType:this.dropType,path:n};t&&(e=t(r)),Object.assign(r,e);const i=new CustomEvent("dndsuccess",{bubbles:!1,detail:r});r.dropedEl,r.position,r.dragedEl;this.dropedEl.insertAdjacentElement(this.position,this.dragedEl),window.dispatchEvent(i,{bubbles:!1})}}catch(n){}finally{this.type&&(this.position=null),e.dispatch("dragEnd",{e:n,ref:r})}},this.dragOver=(t,n,r)=>{if(this.dragedEl&&this.dragedEl.setAttribute("CoC-dragging",!0),0===n.children.length){let[o,a]=(0,i.closestChild)([t.x,t.y],[n]);e.dispatch("dragOver",{e:t,el:n,closestEl:a,orientation:o,hasChild:!0,ref:r}),this.position=l.includes(o)?"afterbegin":"beforeend",this.dropedEl=n,this.type="normal"}else{let[o,a]=(0,i.closestChild)([t.x,t.y],n.children);if("true"==a.getAttribute("data-exclude")){this.dropedEl=a.parentElement;let[e,n]=(0,i.closestChild)([t.x,t.y],[this.dropedEl]);o=e}else this.dropedEl=a;e.dispatch("dragOver",{e:t,el:n,closestEl:a,orientation:o,hasChild:!1,ref:r}),this.position=l.includes(o)?"beforebegin":"afterend",this.type="children"}}};var r=a(n(197)),i=n(155),o=(n(996),a(n(727)));function a(t){return t&&t.__esModule?t:{default:t}}let l=["left","top"]},127:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var r=n(483),i=n.n(r);const o=n.p+"862e2fd973e3d8e9d9daf4bf94ef74e4.css";var a={injectType:"linkTag",insert:"head"};i()(o,a);const l={}},483:(t,e,n)=>{"use strict";var r,i=(r={},function(t){if(void 0===r[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}r[t]=e}return r[t]});t.exports=function(t,e){if((e=e||{}).attributes="object"==typeof e.attributes?e.attributes:{},void 0===e.attributes.nonce){var r=n.nc;r&&(e.attributes.nonce=r)}var o=document.createElement("link");if(o.rel="stylesheet",o.href=t,Object.keys(e.attributes).forEach((function(t){o.setAttribute(t,e.attributes[t])})),"function"==typeof e.insert)e.insert(o);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(o)}return function(t){"string"==typeof t?o.href=t:o.parentNode.removeChild(o)}}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})();var r=n(352);return r=r.default})()}));